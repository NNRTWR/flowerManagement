<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main}" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Flower Management Web Application</title>
    <link th:rel="stylesheet" th:href="@{/css/output.css}">

</head>
<body>
<div layout:fragment ="content">
    <h1 class="text-3xl text-center font-bold">ออเดอร์</h1>
    <div class="container-fluid">
        <div class="row flex-nowrap">
            <!--        side bar-->
    <!--        <div th:replace="~{fragments/sidebar :: sidebar}"></div>-->
            <!--        Main content-->
            <div class = "col">
                <!--        search bar-->
    <!--            <div th:replace="~{fragments/searchbar :: searchbar}"></div>-->
                <div class="row mt-4">
                    <div class="col-md-7">
                        <table class="table">
                            <thead>
                            <tr>
                                <th>Order No</th>
                                <th>Flower Name</th>
                                <th>Amount</th>
                                <th>Order Method</th>
                            </tr>
                            </thead>
                            <tbody id="orderTable">
                            <!-- Sample rows for demonstration -->
                            <tr th:each="order : ${orders}">
                                <td th:text="${order.OID}"></td>
                                <td th:text="${order.FName}"></td>
                                <td th:text="${order.quantity}"></td>
                                <!-- <td th:text="${order.plant_status}"></td> -->
                                <td th:text="${order.order_method}"></td>
                                <!--                            <td style="text-align: right" th:text="${#numbers.formatDecimal(order.price, 1, 'COMMA', 2, 'POINT')}">-->
                                <!--                            </td>-->
                            </tr>
                            <!-- Add more rows as needed -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Order Form (Right) -->
                    
    
                        <div class="order-form">
                            <h6> ยกเลิก Order </h6>
                            <form id="orderForm" th:action="@{/order}" th:method="PUT">
                                <div class="mb-3">
                                    <label for="inputOID">เลือกหมายเลข Order</label>
                                    <input id="inputOID" type="number" class="form-control" name="OID"/>
                                </div>
                                <div class="mb-3" th:if="${canceledOrder.getOID()}">
                                    <p>สรุปรายการ</p>
                                    <div>
                                        <p>หมายเลข order: <span th:text="${canceledOrder.getOID()}"></span></p>
                                        <p>ชนิดดอกใม้ : <span th:text="${canceledOrder.getFName()}"></span></p>
                                        <p>จำนวนดอกใม้ <span th:text="${canceledOrder.getOrderQuantity()}"></span> ดอก </p>
                                    </div>
                                </div>
                                <button id="submit-update-button" class="main-button" type="submit" >ยืนยัน</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
    
      
       

        
        

    

















<script>
    document.getElementById('orderForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const oidValue = document.getElementById('inputOID').value;
        const url = "/order/" + oidValue;

        fetch(url, {
            method: 'PUT',
            body: new FormData(this)
        }).then(response => {
            if (response.ok) {
                window.location.href = "/order?id=" + oidValue;;  // Redirect after success
            } else {
                // Handle error
            }
        });
    });
</script>
</body>
</html>